[{"content":"This post is mainly a post for myself so that I remember how I structure Terraform for when I am deploying it in Azure DevOps.\nFile Structure main.tf providers.tf backend.tf variables.tf variables.tfvars modules main.tf The main file just contains your terraform resource and module blocks, not much needs to be explained here.\nproviders.tf Here is where we can set the version of terraform if we want to ensure that only a certain version of Terraform is used.\nAzure and Random are two other providers I am using since I am deploying to Azure and I am using random for generating my passwords that are stored in Keyvault, other providers such as AWS and Google can also be used in one file which would allow you to deploy to AWS and Azure incase you are wanting to create a VPN between them or something.\nterraform { required_providers { azurerm = { source = \u0026quot;hashicorp/azurerm\u0026quot; version = \u0026quot;~\u0026gt; 2.94.0\u0026quot; } random = { source = \u0026quot;hashicorp/random\u0026quot; version = \u0026quot;3.1.0\u0026quot; } } } provider \u0026quot;random\u0026quot; { # Configuration options } # Configure the Microsoft Azure Provider provider \u0026quot;azurerm\u0026quot; { features {} } backend.tf My backend is in Azure as is being stored in a Storage Account.\nterraform { backend \u0026quot;azurerm\u0026quot; { resource_group_name = \u0026quot;terraformState\u0026quot; #Resource group name storage_account_name = \u0026quot;pocterraformstate\u0026quot; #Storage account name container_name = \u0026quot;tfstate\u0026quot; #Container name in the storage account key = \u0026quot;platformstate\u0026quot; #File name of the state file } } variables.tf and tfvars These files are basic terraform files that I don\u0026rsquo;t think need to be explained, but I use variables.tf to set my variables with any descriptions they need and the tfvars to assign the value.\nThe use of tfvars is not needed as you can assign the value of the variable in the variables.tf file but I like using tfvars as it most projects we are deploying to many environments like prod, test etc and this keeps me in a good habit.\nExample of variables.tf #------------------------------ Subscription Variables ------------------------------ variable \u0026quot;subscription\u0026quot; { description = \u0026quot;Name for Subscription\u0026quot; } #------------------------------ Subscription Variables End ------------------------------ #------------------------------ Platform Variables ------------------------------ variable \u0026quot;platform_resource\u0026quot; { type = map(object({ rg_name = string rg_location = string })) } Example of tfvars #Subscriptions subscription = \u0026quot;40ba55ea-xxxxxxx\u0026quot; platform_resource = { base_resources = { rg_name = \u0026quot;xxxx-xxx\u0026quot; rg_location = \u0026quot;Australia East\u0026quot; } } Module folder Here is where I keep all my modules, not again this is the way it\u0026rsquo;s done and if you are used to using Terraform this is pretty standard, but here it is.\nmodules platform main.tf outputs.tf variables.tf virtualMachine '' '' '' vnets '' '' '' I am planning to do a write up on how I deploy Terraform using Azure DevOps and pipelines and how all this ties in, so stay tuned.\n","permalink":"https://techdox.nz/posts/terraform-layout/","summary":"This post is mainly a post for myself so that I remember how I structure Terraform for when I am deploying it in Azure DevOps.\nFile Structure main.tf providers.tf backend.tf variables.tf variables.tfvars modules main.tf The main file just contains your terraform resource and module blocks, not much needs to be explained here.\nproviders.tf Here is where we can set the version of terraform if we want to ensure that only a certain version of Terraform is used.","title":"Terraform File Structure For Azure DevOps"}]